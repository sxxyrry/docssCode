# Event 事件详解

## 概述

TTHSD 内核提供六种标准事件类型，用于在下载过程的不同阶段向调用程序传递状态信息和通知。

## 事件类型分类

### 流程控制事件
- [***start***](./start.md) - 下载任务组开始
- [***end***](./end.md) - 下载任务组完成

### 任务级事件
- [***startOne***](./startOne.md) - 单个任务开始
- [***endOne***](./endOne.md) - 单个任务完成

### 状态更新事件
- [***update***](./update.md) - 下载进度更新

### 通知事件
- [***msg***](./msg.md) - 系统消息通知
- [***err***](./err.md) - 错误通知

## 事件生命周期

| 会话开始 | → | 任务开始   | → | 进度更新 | → | 任务结束 | → | 会话结束 |
|----------|----|------------|----|----------|----|----------|----|----------|
| [start]  | → | [startOne] | → | [update] | → | [endOne] | → | [end]    |

## 事件处理建议

### 处理优先级
1. **高优先级**：***end***、***endOne***（任务完成状态确认）
2. **中优先级**：***start***、***startOne***（流程控制）
3. **低优先级**：***update***（高频进度更新）
4. **通知优先级**：***msg***、***err***（系统消息）

### 性能优化
- 对 ***update*** 事件实施节流处理
- ***startOne*** 和 ***endOne*** 事件可批量处理
- ***msg*** 和 ***err*** 事件根据级别决定处理方式

### 错误处理
- 重点关注 ***err*** 事件中的 error 级别消息
- ***endOne*** 事件的状态字段必须验证
- ***end*** 事件的汇总统计用于最终状态确认

## 相关文档

- [Event事件机制总览](/zh/event/event-overview)
- [Event键值对格式规范](/zh/event/event-format)
